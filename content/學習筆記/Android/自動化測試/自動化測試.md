# 前言

在Google在2017提出測試金字塔這個概念
![[img_android_testing_pyramid.png]]
測試有三個層次與理想佔比
1. Unit tests - 或稱SmallTest(小型測試)，理想佔比為整體測試的70%。
2. Integration Tests - 或稱MediumTest(中型測試)，理想佔比為整體測試的20%。
3. UI Tests - 通常也指得是e2e Tests，或稱LargeTest(大型測試)，理想佔比為整體測試的10%。

# Unit Test
即單元測試，屬於小型測試，測試速度應為三種之中最快，會在本機透過JVM執行。基本上就是執行Java程式，通常不會需要模擬實機測試。

>[!info]
>Android常用的單元測試工具：
>1. [[JUnit]] 


# Integration Tests
中型測試，包含了多個模組之間交互測試，可能包含UI的測試。

# UI Tests / e2e Tests
大型測試，以使用者的角度出發，不使用任何mocking data，也就是必須與server連線及使用SharedPreference等真實資料，確保使用者實際操作結果都符合我們預期。

>[!info]
>Android常見的UI測試工具：
>1. [[Espresso]] - 對於單一Application UI的測試及驗證功能強大。
>2. Roboletric - 不用模擬器就可以測試UI部份。
>3. UiAutomator - 強項是跨App的測試。

# 測試方法的命名建議

##### 團隊盡量統一命名風格，Android官方並沒有明確的建議命名方式，從官方範例及其他文章可以整理出以下幾個命名重點:

1. 測試方法名稱可以長，最重要是<font color="red">可讀性</font>，不要縮寫模糊。
2. 每個測試方法<font color="red">只測一個行為</font>，所以命名上以該行為的結果為主。
3. 測試方法名稱通常會包含測試對象、輸入值、及預期結果，也就是<font color = "red">methodName_condition_expectedResult</font>，且常用<font color="red">底線</font>做區隔。ex: login_wrongPassword_showsError()
4. 部分開發者還會額外加入<font color="red">test_</font>作為前綴。
5. 也有少部分以<font color="red">BDD導向(行為驅動開發Behavior-driven development)</font>的方式命名，透過反引號fun  \`totalPrice returns 90 percent of total when it is sunny\`()：直接用一句白話去說明該方法要測試的目標，可讀性最高，能讓非開發人員也可以很好的看懂測試結果，呼叫此方法時也需要帶有反引號去呼叫。



參考資料：
* iT邦幫忙的Android TDD 系列 -  <https://ithelp.ithome.com.tw/users/20111896/ironman/2181>
* Fake 與 Stub & Mock - <https://hackmd.io/@AlienHackMd/HycK5pEpo#Fake-%E8%88%87-Stub-amp-Mock>
* The Golden Rules for Unit Tests in Android: A Comprehensive Guide - https://iamjosephmj.medium.com/the-golden-rules-for-unit-tests-in-android-a-comprehensive-guide-fde26977f525
